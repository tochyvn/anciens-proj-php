<?xml version="1.0" encoding="iso-8859-15"?>
<spool nom="localerte_topannonces-pro">
  <initialisation>
    <url>http://www.topannonces.fr/annonces-location-immobilier-u19p:parametre1:.html?PageSize=90&amp;FlatDvals=4294872271&amp;type=2</url>
    <parametres>
      <parametre>
        <valeur>1</valeur>
        <valeur>2</valeur>
        <valeur>3</valeur>
        <valeur>4</valeur>
        <valeur>5</valeur>
        <valeur>6</valeur>
        <valeur>7</valeur>
        <valeur>8</valeur>
        <valeur>9</valeur>
        <valeur>10</valeur>
        <valeur>11</valeur>
        <valeur>12</valeur>
        <valeur>13</valeur>
        <valeur>14</valeur>
        <valeur>15</valeur>
        <valeur>16</valeur>
        <valeur>17</valeur>
        <valeur>18</valeur>
        <valeur>19</valeur>
        <valeur>20</valeur>
        <valeur>21</valeur>
        <valeur>22</valeur>
        <valeur>23</valeur>
        <valeur>24</valeur>
        <valeur>25</valeur>
      </parametre>
    </parametres>
  </initialisation>
  <navigation>
    <profondeur>100</profondeur>
    <pause>0</pause>
    <timeout>60</timeout>
    <thread>5</thread>
    <utf8>1</utf8>
    <rang>
      <a_suivre>  
        <!--<expression>&lt;(div|h3) class=&quot;classifiedTitre marginbtm5&quot;[^>]*&gt;&lt;a class=&quot;boldblue&quot; href=&quot;([^&quot;]+)&quot;</expression>-->
        <expression>&lt;h3 class=&quot;classifiedTitre marginbtm5&quot;&gt;&lt;a class=&quot;boldblue&quot; href=&quot;([^&quot;]+)&quot;</expression> 
        <remplacement>http://www.topannonces.fr$1</remplacement>
        <limite>100</limite>
        <suivant>1</suivant>
      </a_suivre>
    </rang>
    <rang>
      <a_capturer>
        <expression>(.+)</expression>
        <remplacement>$1</remplacement>
        <option>s</option>
        <limite>1</limite>
      </a_capturer>
    </rang>
  </navigation>
  <capture>
    <destination>localerte_topannonces-pro.csv</destination>
    <echappement>\</echappement>
    <separateur>;</separateur>
    <encapsulateur>"</encapsulateur>
    <ligne>CRLF</ligne>
    <enlever_balise>1</enlever_balise>
    <enlever_entite>1</enlever_entite>
    <exclusion>
      <fichier>exclusion.csv</fichier>
      <expression>cherch</expression>
    </exclusion>
    <parent>
      <expression>(.+)</expression>
      <remplacement>$1</remplacement>
      <option>s</option>
    </parent>
    <enfant>
      <expression>(.+)</expression>
      <remplacement>$1</remplacement>
      <limite>1</limite>
      <option>s</option>
    </enfant>
    <colonnes>
      <colonne mode="valeur" nom="Site">
        <valeur>TopAnnonces</valeur>
      </colonne>
      <colonne mode="valeur" nom="Ok">
        <valeur>1</valeur>
      </colonne>
      <colonne mode="expression" nom="Date">
        <expression>publi&amp;eacute;e le ([^&lt;]+)&lt;\/div&gt;</expression> 
        <remplacement>$1</remplacement>
        <recherche>ENFANT</recherche>
        <limite>1</limite>
        <filtres>
          <filtre>
            <expression>[^0-9]+$</expression>
            <remplacement />
          </filtre>
          <filtre>
            <expression>([0-9]{2}) janvier ([0-9]{4})</expression>
            <remplacement>$1/01/$2</remplacement>
          </filtre>
          <filtre>
            <expression>([0-9]{2}) f.+vrier ([0-9]{4})</expression>
            <remplacement>$1/02/$2</remplacement>
          </filtre>
          <filtre>
            <expression>([0-9]{2}) mars ([0-9]{4})</expression>
            <remplacement>$1/03/$2</remplacement>
          </filtre>
          <filtre>
            <expression>([0-9]{2}) avril ([0-9]{4})</expression>
            <remplacement>$1/04/$2</remplacement>
          </filtre>
          <filtre>
            <expression>([0-9]{2}) mai ([0-9]{4})</expression>
            <remplacement>$1/05/$2</remplacement>
          </filtre>
          <filtre>
            <expression>([0-9]{2}) juin ([0-9]{4})</expression>
            <remplacement>$1/06/$2</remplacement>
          </filtre>
          <filtre>
            <expression>([0-9]{2}) juillet ([0-9]{4})</expression>
            <remplacement>$1/07/$2</remplacement>
          </filtre>
          <filtre>
            <expression>([0-9]{2}) ao.+t ([0-9]{4})</expression>
            <remplacement>$1/08/$2</remplacement>
          </filtre>
          <filtre>
            <expression>([0-9]{2}) septembre ([0-9]{4})</expression>
            <remplacement>$1/09/$2</remplacement>
          </filtre>
          <filtre>
            <expression>([0-9]{2}) octobre ([0-9]{4})</expression>
            <remplacement>$1/10/$2</remplacement>
          </filtre>
          <filtre>
            <expression>([0-9]{2}) novembre ([0-9]{4})</expression>
            <remplacement>$1/11/$2</remplacement>
          </filtre>
          <filtre>
            <expression>([0-9]{2}) d.+cembre ([0-9]{4})</expression>
            <remplacement>$1/12/$2</remplacement>
          </filtre>
        </filtres>
      </colonne>
      <colonne mode="expression" nom="Id">
        <expression>v([0-9]+)\.html</expression>
        <remplacement>$1</remplacement>
        <recherche>LOCATION</recherche>
        <limite>1</limite>
      </colonne>
      <colonne mode="expression" nom="Ville">
        <expression>class=&quot;detailVille&quot;&gt;[^a-zA-Z]+([^(]+) \([0-9]{5}\)</expression>
        <remplacement>$1</remplacement>
        <recherche>ENFANT</recherche>
        <option>s</option>
        <limite>1</limite>
      </colonne>
      <colonne mode="expression" nom="Code Postal">
        <expression>class=&quot;detailVille&quot;&gt;[^(]+\(([0-9]{5})\)</expression>
        <remplacement>$1</remplacement>
        <recherche>ENFANT</recherche>
        <option>s</option>
        <limite>1</limite>
      </colonne>
      <colonne mode="expression" nom="Type">
        <expression>&lt;title&gt;([^&lt;]+)&lt;\/title&gt;</expression>
        <remplacement>$1</remplacement>
        <recherche>ENFANT</recherche>
        <option>is</option>
        <limite>1</limite>
        <filtres>
          <filtre>
            <expression>^Annonce</expression>
            <remplacement />
            <option>is</option>
          </filtre>
          <filtre>
            <expression>^Location</expression>
            <remplacement />
            <option>is</option>
          </filtre>
          <filtre>
            <expression>.*(studio|maison).*</expression>
            <remplacement>$1</remplacement>
            <option>is</option>
          </filtre>
          <filtre>
            <expression>.*Appartement ([0-9]) .*$</expression>
            <remplacement>T$1</remplacement>
            <option>is</option>
          </filtre>
          <filtre>
            <expression>.*(chambre).*</expression>
            <remplacement>studio</remplacement>
            <option>is</option>
          </filtre>
          <filtre>
            <expression>^.*F([0-9]).*$</expression>
            <remplacement>T$1</remplacement>
            <option>is</option>
          </filtre>
          <filtre>
            <expression>^.*T([0-9]).*$</expression>
            <remplacement>T$1</remplacement>
            <option>is</option>
          </filtre>
        </filtres>
      </colonne>
      <colonne mode="expression" nom="Loyer">
        <expression>&lt;span class=&quot;detail-price font-20&quot;&gt;([0-9]&amp;#160;)?([0-9]{2,3})</expression>
        <remplacement>$1$2</remplacement>
        <recherche>ENFANT</recherche>
        <option>i</option>
        <limite>1</limite>
        <filtres>
          <filtre>
            <expression>([0-9])&amp;#160;([0-9]{3})</expression>
            <remplacement>$1$2</remplacement>
            <option>i</option>
          </filtre>
        </filtres>
      </colonne>
      <colonne mode="expression" nom="Description">
        <expression>&lt;p class=&quot;detailAnnonce&quot;&gt;\r\n\t([^&lt;]+)&lt;</expression>
        <remplacement>$1</remplacement>
        <recherche>ENFANT</recherche>
        <option>s</option>
        <limite>1</limite>
      </colonne>
      <colonne mode="expression" nom="Titre">
        <expression>&lt;title&gt;([^&lt;]+)&lt;\/title&gt;</expression>
        <remplacement>$1</remplacement>
        <recherche>ENFANT</recherche>
        <limite>1</limite>
      </colonne>
      <colonne mode="valeur" nom="Part/Pro">
        <valeur>PROFESSIONNEL</valeur>
      </colonne>
      <colonne mode="valeur" nom="Meublé">
        <valeur />
      </colonne>
      <colonne mode="expression" nom="Image">
        <expression>&lt;img id=&quot;mainImage&quot; src=&quot;([^&quot;]+)&quot;</expression>
        <remplacement>$1</remplacement>
        <recherche>ENFANT</recherche>
        <limite>1</limite>
      </colonne>
      <colonne mode="expression" nom="URL">
        <expression>(.+)</expression>
        <remplacement>$1</remplacement>
        <recherche>LOCATION</recherche>
        <limite>1</limite>
      </colonne>
      <colonne mode="valeur" nom="Email">
        <valeur />
      </colonne>
      <colonne mode="expression" nom="Téléphone">
        <expression>(&lt;span[^&gt;]+&gt;(([0-9]{2} ){5}) ?&lt;\/span&gt;)</expression>
        <remplacement>$1</remplacement>
        <recherche>ENFANT</recherche>
        <limite>1</limite>
        <filtres>
          <filtre>
            <expression>([^0-9]+)</expression>
            <remplacement />
          </filtre>
        </filtres>
      </colonne>
    </colonnes>
  </capture>
</spool>
